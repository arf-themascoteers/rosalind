import numpy as np

dataset = """>Rosalind_1361
ATTAAACTGATTCCCAGGATCTTGTTCCTGATGTTGCCTGAGGTGACAGCTGTGCAGTGC
ATTATGGAGCCATAGTTACAGCCCAAGTCAAGCGTTTAAGGCTGTAAATTAAACCAAACA
GTAACGGTTAGTTACGTGGTTGGCCGAGCCGTGTTGATCCAGTTCACATAGCCAACACCT
CACCAAGCCAATCTGCCTCCCTAAAAAGTACGGCGTTACTAAGCCACTAGGAATCGCTCG
TACTTAAATAGTTGTCACAGCATACACTTGAATTATTGCATGTTCTGATGGTCTTTAAAG
TGTTTGCGGAGAACCGTGGTTGTTAACAGTCCAAATGCCTAATTCCAACTGCTTAGAGTC
TGTCTCGCCTGTCTTATCTTGTATCGTGTGCAAGAGTTTGTTTGATATGGCCAAGGCATT
GCCGGTATGCAACCGCAGGAAGTAATTGTGACTATCCTAGACGACCTCGGTCGTGCTTGT
TTTCTCCACAATTAGCGAAAGGTTCCGGTCGGAGTGATCCCTGACTACACTCAAAGCTCT
TAAAGGAAACATGGTGGTGAAGGTTTCTGAGACCGCATTAGTGCTCTGCTCCTGTCTGGG
ATGGTACTTCGTCCGGCTACATCGGTGGGGTGCAGACGCTGAGTATATGACAGGTCCCAA
GTTCGTGCACCTCGATGAGCCCCGCCAGTGAGGATGAGGCACTTCGCCCACCCCTTTGGA
GACCGCTCTCTATTCACGTATGTTACCAATGTCCTCGGAAGTAAACCCCGGTCGGATGAT
GGTGTTTAGGGTTCTCATCTGCTCGGGACTCTCAGTTTATGGAGGCGAGCGGCTCCATAT
TAACCGCCAAGAGGGGCATTCGGCTGGAAGGAAGTCTGACGTAGACCTTAGGTTGGTGAC
TACGATGCGGAACGAGACGTGCGTAGCTAGCTCTCCACGATCG
>Rosalind_0293
GCGAATCCGAAACACGGTAGCCGTTTACTCAGTTATTTTTAGATCGACAACACCGACGCT
AGTCAACTGCCCTACGATAGTTGCGGATTTATCTCACCCCTTCGCTATCCACGTCCCGTC
TCGAGAAACCTGATTTTTTATTTCAGGTCGCCACCATTTAAACGTAAGGATCCACTTTAC
ATACAGTTGGTATTCGGCGGGAGAGATGGTAGCTCCCACAAACTGTTTCTAACGCGGAAA
CATTCGAGGTGGCTACTGAAGACGCGGGGAGTACAACGGTCGCTGAGGCTAATTATGGGG
GGGATTAATCCATTACACCCTTGTGTCGACTGAGAATATCCGACCGTAGACTCCGCTCGC
CCGACCCGGGGAAGCATTCTGGACGTGGAACTAGGCAAGTAACTTTGGCGTCCTTGAGAT
ATAAGGGACGGGCGATCAAGTTCCCTAACTATATGCGTTGAGCCCGACAAGCACTGACGC
TGAGTATTATGGTAAACCGGGTAGTGATAAGGAGGGCGCGCCGAAAGGGAAAAAGTGAAC
AAATCGCTTTTGTAGATACTCCTTAGACCTATGTATAGGCCGATATCACCAGGGGCCGCT
TCAGCAGTCTGAACCGCCCTCGGTGGACTGGTCTTAACGTATTAGTCATTCCGGAATGCC
CTAGCCACAGGGCAGCGGAGAATTCCAGCAAAGAACAGAGCGCAGGGACGCTGTGTATAC
CTTCAAGAGGTCGGGCAATTATCCTGAGCCTCCCCTTACCGGATGCAAGCCTATAGGAGT
TGTGAGGAGTGGTGACCATATCCGTTAGGTCCTAATGGTCGCCGGTAAACCCGCTTAGAA
CGGCTGGTCTCAAACCAGCCCGGCTGCCACTAGCTCGCTAGAGATGTCAACTTAATGACA
GCGTTCGGCGAATCGCGCCTCCTGTTGGCGCCGACGTCCGCGA
>Rosalind_0590
CGTTGGTGACGTCTGGGATGCTAAATGGAGGCGTTCTTAGCCGTCGGGACATTTGAAATT
CGCCCCTGTTTTTCTTTTGCCGTAGAAAGGCTGAGATGACAGGATAACGAGGCATCGTGA
GCTCAAATATATTGGTCTTATCCTTTCTTAACTTTGGTGAGGCCACAAAATGCGCGCGCT
TTCGGCAGCGGATAGCCCCGCGGACTTACAGAGCACCTGCGCAGCATCCGTCTACGGTAC
AATTAGCTGGGGTACCATTCAGATAAGTTAATTAGGTTTACCGCGTCACTTTCTTATGAT
CTCAAACCCCCAATATACCCCTATAATCGGTTCCGTTAGACCTCCATATGCAACTGCGGT
AAACGCAGGATCAGCCCGAAGAAATTAGTTTACACAGTTTCGCCTGGTGCCGAAACTTTC
GTAGTAGTTTTTTGGGATATGGTATTGCCTCTAGTGAAGTTAGCTTTAAAGCTTCCCATG
TTGATTAGTAAGCATCTCCAAGTTCCAAAGGGAAGTGATATTTCATGGAAGACCTTCTTA
ACAGGGAAATGGTGAGGACATCAACGATGAGTTCATGGTACCTATTAGGTTTCGTCTCAT
CGAACTATGACAATTGTTCCCAGTCCCCTCATGGAACAGCACTATTATACGTTTTGGCAG
GAATACAGTGCTTCGGGATGTGTTGTGTCCTTTCGTGAGGAGCTAACTTGAGGATGGTTA
GTGTACGGCCTTTCACCTGGTCATCACGGCTACGTGCGGGCGGGGACTACTAGACATTGG
GTCAACATATTACTGAAACTAATTCATGCGGGAATGGGCACAGTTCTATACACGGTAGAC
ATCTGCTCTTCTCACACCGTGTGGGGGTGGAACCTACCCGGACAGACCACCTCCCCAAGT
GTCTGGTAAGAGAGTTGAATTCGTATACCTGACTCGCGCAAAG
>Rosalind_8317
TGAGCTGTGATAAGGGACTTACCATAAGAACTTTTGTTAGGACAATGCACACGAAGTCGG
ATGGGTTTTCTGAGTCTCCTTCCTAATTATCCTCCGTTCTGCCCTGCATACTTCGTAGCG
CGGAGGTGGAACAATTAGAGCAGAAGGGGTTTCAACAAGCAACGTCAGACTATCTTCTTG
ACATAAACTATTGCTGATACAATCAGGTTCTAGCCCGTAAAACAGCAGACCCCGTCTAAT
TGATATTGTTACGATTCCCTGAAACCGGAGCCTGGCTCGGATTGAGCTTTCGCCAATGGC
GCTACTGGAATTATTGGCTTTCAGGATTACGGGCCGTTATACACTCATTTGAACTAGGAT
AAGAAAGAGCGCTATTATCTCTGGACACGTAGAAGCACGCCAGAGACAGTACCTGTCGAG
GCGCAGTATTCTTTCACCACTTGAGTATCACTCGTAGAGAGCTTTACGCAGGTACCAGTG
ATGCTCTTACAGCTTAGGTTTCCCAACCTCAACCGTAGGATACAGGGCCGGCTGACGTGC
ATTGAAACACGTTCGAACGCCTTACATCAGTATATGGGGCGTTGGGTGAGACGAGGTCCT
AGACATTGGTTGGGCAGGAGCTCAGTGCAGCAAATAGCCATTTACTGCAGCGAAACCAAA
CGGTTCATGCTTATACAGTTGATTGACGGTTTGTTCCTACTTGGACATTCGTAAACTAAA
AGGAGGACCGACCAAGAATCAATTCCGATAGTTAGATTTGTGTTTTGTCCATCTGGGCTA
GGTTATTCGGAAAGGGGTACCCAGATTCATTATCAAGACCAGTCTATTCATGTTTCTTGT
GGTTAGTTATACCATTTCTGCAAACTTGTCGAGTTATATTAATTGCTGTTTTCATGAATC
GGCGGGAATTTTAATGTTAAGGCAAGTTCTTCAAGGCCGATTG
>Rosalind_6575
ACATGTCTATTCGATCAATGAGTCAATCAGACGAGCGAGCGCCTAACCCAATGCCGTATG
GCTTAATAGCATATGTGTCTCAAGTTACAGTTTCCACTGCGAGAGGTCCGGTCACCATGC
TTGGACACCGCAGCCACCCCGCCCCTATGTGTTATAGTAGACCGCTGAGGACTCAGTCTA
AACTCGTGTGTCTGACGATTGCCATAGCCGGGGCGGTCTTGGCACAGACCGGAACAGTTG
TAAGGCCACCGAACATGTGGGTGTCTGAGATAAGCGATGCAACACAGCAAGACCAACAGT
CCCCAGAGCTCTTGGTGCCGACTCGGTGTAAAGAACCTTAGTTTAAGTTTTCAAATGAGG
CGATACTGGAACAAGTTGATCACCAACGCAATCCGGGTCGTTAAGCGCAAGGCCAAGAAG
TAAATATTTTGCCTAATAACGATTTTCTACTATGAACTAGGTCCAGCCGGGGGCCAGTTG
CCAGTACCGTTTCATGTAATTCTATGGTACCTATCTGTACTTTATGTAGTGATTAGTCGT
TAGTGTTCGAAGTCGATCCTGACACAACAGGTTTATCGAAAATTTTTTAATTGTGAAAGT
GCTTGGAATAAAGAATTGTCCATGTGACTTCCCTACAATAACGCATGGCTCCGTCGCGAC
GCCAGAACGACGGCTAGCTAGAGCACGTCGGGCATCCCATCGTGACTGTCTATGCATGCC
CTAATTGTGTAGTTGAGTCAAATGGCGCGCTACTCGAAAAACGATGAAGATACATGAGGG
TCCTACAGATGGTCTAGTCTCTCTGATGCCGGGCGGATACCATTCAAAACCCCTTGGGAA
ATAACACATTCAGCTATACTGCTAATATGACTACATGGCAACATTTGCCCAGTTTTAAGG
TGTTCTTCGGGCCAGCGTCTTTGAGTCTAGCCGGCCGTTTAAG
>Rosalind_0647
AGGGAGCTGGGGATCCCCTATAGTCGTACCAAATCCACGGGAGTGCAATCGGGTACATTT
ACCCTAGCGTGCATTAAGGGACAGTTTGCAAATAGCATGCTTGTAGGATTTCTCTTCTTT
CCCCGGATACGGTCGACAAGCAGTCAACGGCAAGTCGATCTACCAGCAACGCCCGCTTCT
GGACAACCTAAACCTGGCTGTGCGGGCTCATGACATTTGCAGGAGGATGCATTTATTAAA
AAGTACCGGGCAACGATCGGGATACGATCCTCGAAATCACTATATAATCTGCGAGTTTCG
CTGATGGTGAGAGATTCACACCGGAGACAGCAATACTCGCAATCGTAAGGCGTATTACCG
TTTTTCCGCGGTCCGCAAGGGCAGAGTAAAAGCTAGGGTAAAGCATACCTTATAGGGAAT
TTGTGCGACGGCTCTGTTTTAGCTCTAGGCTAACAGACCACAGTACTTCCTTTAGCGCCC
ATTCTAAGTCTTCAGTATCCCACCCGGTTGCCGCTTCGGTTTACGCCCCTATTTGTATCT
CGGACAATAGTTGAATCATAAGACAAACCCGTGGGTAGTTTCAACTCCTTACCTGGCAAA
GTGATTCCGCCGATGTATGCCCTCACAAGTTTACCCTGTGTGTAAACCCACGTGTGGATT
TAGCTTACGGTGTTACACGTTGCTCATGGGCCATCTAAGTAGGTTCAAACTCTTAATCAT
GTCAGGCGCGTGTTTTTGAACTGATGACAGTTGTAGGACTTAGTTCTACGTATCGTCCAC
CAAATTAGCGAGCGCAGTGCACTCAGTGTGCTCGCATAATGAGTAGGTGAACGAAAACCG
CAGGGAGCTCTTTGGTCTAGTATCTTAGACAGGTGAGAGTGTTGCTGGCAGGATGGTTGG
GCGCAGCAACAACTCAAGATCGAGCTCACTATCCATCCAGGGT
>Rosalind_6307
GTCCGAAGACACATTGGGGCAGCGATTGTAGCTGGACGAGCTTCAATTTACTGCGGGGCA
CTGCAAAGTTTACTGTGCCTGATCGGTACGTCACGCTGTCTAAAGATGCAGGCCGTGGGC
AGACTCAGAGATCGAGCTGACATTACACACCGCCCGCGCGGGGTGGCGAACAACCGAGCC
ACCTGGCCGTGGCGGCTATGCATCGGCTAGTCGCATCAAAAACGTCCGGTTCGGTAGTAA
ATCCATTGCACCCGATCATGGATGAGTTGCCGATGCATTAACGCGATTGAGTCGAGGAAA
CGGCAGGGGAATTTTCAACCAAGTGATTCTGATGCTAACGACAATAATCTACTCCCACAA
AGACTCGGGTGGTAGGGTTTGTTGAGCCTCAAAGCATACTATCGGACCATGGTTAGAAGA
AACACGGGATACTTGTCCCTAGGCCGAAGCTCCAACCTAATTCGGTGAGTGGCTACTAAG
AAACAACTGTAAACCTTCGTCAACTCGCCTTAGAGATTACTGACCTGGGCCTTCGGGCAT
CTTAATCGATGCCAATACGTGAGTATAGGTCAAGATCTCGTGACCTGTGTTCGTACAACA
ACAGACTAATATAGTTAAGGACCGTGGGAACTCGGCACACTCACTTACCCCCTACCCCAA
CATTTCGCGCGCGCTAGCACGGCGACTAGTGACACCGTATCTATGGCAGTGTTCGGCCGT
CAGCGCGGACGGATGTGATGGCCTAATCAACGCACCTACAGGGCATAAAAAGGGGGTGGC
ATTGTTAGGGTGCGCCCAGAGCAATTACGATGTAACCATTCACCCCTACGTCATGCTAAC
AGTTGAAGCGTAATTAGATCTAACAGTGGGCACGACCCCACGCGGTAAACTAACGTGCCG
ATGCAAAGAATCCTTAAGAGGAGTTCCGATTTTGTGCGTGTCG
>Rosalind_8316
TGTGGCGTATACCGTTCGGCGAGGAGTCTTTACCACAGTCTGTGGCAACGAGCAGAGCTA
CACGTGGCCGGCATTTTAAAAATCGTAGGTGTGCAATTCGTAACAGACTACGCAAGCTAG
TGACACGTATTGGAACCTTGTACTAGACACCTACGCCCCGGCCGCTCGGAAAAGAGCGAT
ATCTGTCACAGGCGCAGGTACCATCCCGACACAAGAGCTTGCTGGTTGCTCCCTTGGATC
TTTCGAGAGTCTGATGGTCATACTTTACTAGTGAAATTAGGCTTTAAAAAAAGGTCAAAG
CAGTAGTGCCTATTAAACCAGATTGTGTCAAACGTGCGTGCCGCCATTAGCGCGATGCTG
TAGCGGTGCCAGCATGCGGACCCACGGCGCATATTTGCTGACCTCCTCAAAACAATACAA
GCTAAGCCTAACTATTCGCGTCGCCAAACCGAGCGATGATCTGCGGAAAAGGTGCTTTGA
GCGGAGGGGACGATGTTTAACTATGTTATCACTTTAGCAACCCGAGGGCCCGCCCGGCGC
CCTGGTGGAAGGGGTTCCGGAGTGTATCCTACTCTAGTCCCGATCTCGCAGAGCTCAAGT
GCTACAAGGTCAACTTCTATCCTCACGGCTTTGATGATGCTTGCCCCTGGAATCGCCCGG
TGTCGAATGCAAAAAGTCTGCGCCATAAGTTGAGTTCGGGTGATTCAGACGAAGAGCATG
CACTACCAGTGCCCCCAAAGTACTAGACGAACTGGCTCTTTCTATATTCGTCTGCTGCAC
GAGTTTACAATTCCCATTCCGAAGAATCCGAATTGAACGTCCTAAGTTGGCGAATAAAAA
GGCTAGCTTCGACTAGACAATCACGCGTTGACCGTGTAGAGGCTTGGTGGCATTGCTGCG
GGACACACTAGCGTTCACACTGGAAAAACCGGACCACTCGCCA
>Rosalind_0866
TGTCGATCCGAGCGTGTACGTGATCCTATCGCAACTGTGTGCTTGGGATCTCAACGGCCG
GTAGAACGATATAAAAACAGATAGTTGGATCGATATACTATATCGTGTGTCTAATCAGAA
AGGACACTCATACAATGACAATGAATTCCAGAACTCACCGTCACCTTCGCTACACGACAG
GCCACCTGTCTCGCGGAAGGCATCCGCAACAGGTCGCCGTGCGACCACAGCGTTGTCCAA
CCTTTCACGTCTATATGCCGATTTTCCCGGAGCGCCACGCCTTGTGCTTGATACGATACT
TGTATATTAGCTAATCGGGACCAATGGAAACCGGCTGTTTCGATTTATGTTGAGTCGCAC
TCTATCAGGGCCGGGTTCACGCAGGCCCTATGGGGATGAGTAGGGAAGTCCTGCTTTCGC
GCGAAATACGCTGAGGGACGTTAGTTCGCTTGGGTCATATCAGATGGGCAGGTCAGGCCG
TACACGCAGCGAATGTGACGTCACAAGTGAAGCCTTAATTATAAGTTGAGCGCGATCGGG
TTGAATAACTCTACAAACAGTTTTTCAGGGCTCCATGTCATCCCGTTTAAGTGATCCAGA
TAATGACTGTGGATTCTATTTAAAGCTAGGACATTGGGGGTCGCACTGAAAGAGACGTTA
GATACAATGCTGCCATGTTGTCCGAGTCTTTCTACGAGTAACACAATGATCACCTAGGTA
CACGACGTGACCTCATTTGTCGTCCGTACGCGCCCTTGTAACTACGGGCTTTCTAGTGTG
AATGACCACTGATTAATGTTCGCGCACCATGATTGGGATCCACTAAAGTTCTAGGCCTAG
TAAAGGGTAGCAAACTACTCCGTTCCGACCTTGTTTCAGTACTTCCTGGCTCGCTAAGCT
CCGCAGCGGAAGCCTGTGCGTCTCTCAGGCCATGAGCACGGCT
>Rosalind_3307
GTACTATGGGCCCGCATCGCATCTCAATTCCATGGTAACTGAGTCTTGGAGACAAATCGA
ATTGAAGCGGGATCTCGAAACCGACAACCTGCCTCGTGATGCATATCAGTGTCATAATAT
TAAGCTTTCAATAACATCCTACACATGTGGTACACATTAAGGAACTAGAATGGTCGCGAT
CACAAAACACTTGTTTCTTTCTGTCCATATGTCGATCCGTGTAGCTGTAGCCCACTTTCC
TACGATATGCTACCTGGTTGACAACTGGAACTACTACGTTCTGTAAGGCGTGTGGCAGGT
CCACGCGTCCAGATTCGACTTCGGCGTGTGGAGAACCTACGGAACTCTTTGTAGCCACGT
TACGCCTTAGGACTTAAACTAAAACGGTGAACATTAGACCTCCATTTTATTTCTGTGCGA
ACTGCTCTTGTTGCAAGTCAGCCTTCGATTAGCTTCATGTACTCTCCGACAGGTCATAGC
TACATATTAAACGAGCGGCGCGCGGCCAGGTCTCAGGAGGGTGCTGACCTACGCTCTGCC
ATCTCTAAGCGCTCGTTAACCCTTAGGGGAAAAGGCACGAAATCAGCGGCATATAGACCA
TATTACCCGCTACTGTTTTGGGTGGTGAGTTGACGTCTGGAGGAGTGAGCCGTAGTAGAC
CGAAGCATAGGGGAACGTGAACCTGGATAGTGGGTATTCTTCCTTACTAAACGGAACCAC
CCAGTACTGACCGTTCACTTCGGCGACGTGGTTTGGGCGAGCAGACGGTGTCAAATCAAA
CCCCCTGTGCAAAAGGGACCGTGCGGTATTATATACATATCGAGCCACCTGATATTAGGA
AAGTTCCTCCAGCAAGCGTGATGAAGGGGTGGGTGAAACGGATCTTAAATCGTCACCTAC
AAGGTTCCATATCTCAAATGCGACATTACAGTCCGCCCCAGTG
"""

matrix = []
lines = ""
index = {
    'A' : 0,
    'C' : 1,
    'G' : 2,
    'T' : 3
}

rev_index = {
    0 : 'A',
    1 : 'C',
    2 : 'G',
    3 : 'T'
}

for line in dataset.splitlines():
    if line.startswith(">"):
        if lines != "":
            matrix.append(lines)
            lines = ""
    else:
        lines = lines + line
matrix.append(lines)

n = len(matrix[0])
profile = np.zeros([4,n], dtype=np.int)
for line in matrix:
    for i in range(len(line)):
        profile[index[line[i]]][i] = profile[index[line[i]]][i] + 1

consensus = ""

for i in np.argmax(profile, axis=0):
    consensus = consensus + rev_index[i]

print(consensus)
for i in index:
    print(f"{i}: ",end="")
    print(" ".join([str(i) for i in profile[index[i]]]))